{% extends "base.html" %}
{% block title %}{{ meta.name }} — WikiMaker{% endblock %}
{% block content %}
<h1 class="page-title">{{ meta.name }}</h1>

<div style="margin-bottom: 1.5rem; display: flex; gap: 0.75rem; align-items: center;">
    <a href="/{{ meta.slug }}/add" class="btn">Add Source</a>
    <a href="/{{ meta.slug }}/new" class="btn btn-secondary">New Concept</a>
    <a href="/{{ meta.slug }}/settings" class="btn btn-secondary">Settings</a>
    <form method="post" action="/{{ meta.slug }}/retag" onsubmit="return confirm('Retag all concepts using the LLM? This may take a moment.')" style="margin: 0;">
        <button type="submit" class="btn btn-secondary">Retag All</button>
    </form>
    <form method="post" action="/{{ meta.slug }}/delete" onsubmit="return confirm('Delete the entire {{ meta.name }} wiki? This cannot be undone.')" style="margin: 0;">
        <button type="submit" class="btn btn-danger">Delete Wiki</button>
    </form>
</div>

<form class="search-bar" action="/{{ meta.slug }}/search" method="get">
    <input type="text" name="q" placeholder="Search concepts...">
    <button type="submit" class="btn">Search</button>
</form>

{% if all_tags %}
<div style="margin-bottom: 1rem;">
    {% for t in all_tags %}
    <a href="/{{ meta.slug }}/search?tag={{ t }}" class="tag">{{ t }}</a>
    {% endfor %}
</div>
{% endif %}

<h2>Concepts</h2>
{% if concepts %}
<ul class="concept-list">
    {% for c in concepts %}
    <li><a href="/{{ meta.slug }}/{{ c.slug }}">{{ c.title }}</a></li>
    {% endfor %}
</ul>
{% else %}
<p style="color: var(--text-muted);">No concepts yet. Add a source to get started.</p>
{% endif %}

<h2 style="margin-top: 1.5rem;">Sources</h2>
{% if meta.sources %}
<ul class="source-list">
    {% for s in meta.sources %}
    <li>{{ s.label }} <span style="color: var(--text-muted); font-size: 0.8rem;">— added {{ s.added[:10] }}</span></li>
    {% endfor %}
</ul>
{% else %}
<p style="color: var(--text-muted);">No sources added yet.</p>
{% endif %}
{% endblock %}
