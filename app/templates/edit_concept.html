{% extends "base.html" %}
{% block title %}{{ "Edit" if mode == "edit" else "New Concept" }} — {{ author_name }} — WikiMaker{% endblock %}
{% block content %}
<div style="font-size: 0.85rem; margin-bottom: 0.5rem;">
    {% if mode == "edit" %}
    <a href="/{{ author_slug }}/{{ concept_slug }}">&larr; Back to {{ title }}</a>
    {% else %}
    <a href="/{{ author_slug }}/">&larr; {{ author_name }}</a>
    {% endif %}
</div>

<h1 class="page-title">{{ "Edit: " + title if mode == "edit" else "New Concept" }}</h1>

<form method="post" id="editor-form">
    <div class="form-group">
        <label for="title">Title</label>
        <input type="text" id="title" name="title" value="{{ title if mode == 'edit' else '' }}" required
               style="width: 100%; padding: 0.5rem; border: 1px solid var(--border); font-family: inherit; font-size: 1rem;">
    </div>

    <div class="form-group">
        <label for="content">Content</label>
        <textarea id="content" name="content">{{ content if content else '' }}</textarea>
    </div>

    <div class="editor-actions">
        <button type="submit" class="btn">Save</button>
        {% if mode == "edit" %}
        <a href="/{{ author_slug }}/{{ concept_slug }}" class="btn btn-secondary">Cancel</a>
        {% else %}
        <a href="/{{ author_slug }}/" class="btn btn-secondary">Cancel</a>
        {% endif %}
    </div>
</form>

{% if mode == "edit" %}
<form method="post" action="/{{ author_slug }}/delete/{{ concept_slug }}" style="margin-top: 2rem; padding-top: 1rem; border-top: 1px solid var(--accent);">
    <button type="submit" class="btn btn-danger"
            onclick="return confirm('Delete this concept? This cannot be undone.')">Delete Concept</button>
</form>
{% endif %}

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/easymde/dist/easymde.min.css">
<script src="https://cdn.jsdelivr.net/npm/easymde/dist/easymde.min.js"></script>
<script>
    const easyMDE = new EasyMDE({
        element: document.getElementById('content'),
        spellChecker: false,
        autosave: { enabled: false },
        toolbar: [
            'bold', 'italic', 'heading', '|',
            'quote', 'unordered-list', 'ordered-list', '|',
            'link', 'code', '|',
            'preview', 'side-by-side', '|',
            'guide'
        ],
        status: false,
        minHeight: '300px',
    });
</script>
{% endblock %}
